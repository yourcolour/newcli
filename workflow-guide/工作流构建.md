# 工作流程建设

工欲善其事必先利其器，一个好的自动化工作流程能够让开发省不少心。下面说的本项目，均指代的是【古井贡项目】。

#### commitizen + validate-commit-msg + husky Git提交信息校验

在这个项目开始之前，大家的 commit message 都写的比较随意，虽然不至于毫无意义，但是也对阅读提交记录帮助不大。这样就带来几个问题：

* 难以查找提交记录，git log 查看到的都是一些没有意义的文字，对问题查找几乎毫无帮助  
* 难以确定发版范围，发版内容只能靠个人记忆，难保有无意中提交的内容没有汇报到发版内容中  

所以，一般来说， commit message 应该能够说明当次提交的目的。不过人都有偷懒的倾向，而且也不能为了一个好看的提交记录增加大家的工作量。所以在古井贡项目中，我们采用了Angular 规范，并且引入了三个工具来帮助我们得到一个符合规范的提交记录。

* commitizen：CLI工具，能够使用交互式界面来进行提交信息的输入，减少手动调整提交信息的工作量。提交代码时运行：git cz 即可。
* validate-commit-msg：提交信息校验工具，能够校验提交的信息是否符合规范
* husky：Git Hook 工具，能够更方便的利用 git 钩子，此处用于配置在提交代码之前调用 validate-commit-msg 进行提交信息校验，校验失败则拒绝提交代码，杜绝不规范提交信息的提交。

现状：1.已经能够有统一格式的提交信息。2.但提交内容仍然存在随意提交的情况。主要原因是开发节奏太快，提交内容不太好拆分组织，一次提交可能有多种内容。而且刚开始接触提交信息校验，还不太熟悉。

> 详细内容可以查看：[gitCommit规范指南（复制）](./gitCommit规范指南.md)

#### husky + lint-staged + Eslint 代码提交校验

eslint 已经在部门引入很久了，今年的项目已经全部加上了eslint校验。但是在古井贡项目之前，虽然有 eslint，但是也只是校验了本地代码，无法阻止同事无意（或者强行）将问题代码提交到代码库。

鉴于上面的情况，在本项目中，我们同样组合了几个工具来进行代码校验并且防止误提交：

* husky：此处用于配置在提交代码之前调用 lint-staged 和 eslint 进行代码的校验
* eslint：代码校验工具，校验整个本地代码
* lint-staged：代码校验工具，校验本次提交所修改的文件

> 详细内容可以查看：[用husky和lint-staged构建超溜的代码检查工作流](./用husky和lint-staged构建超溜的代码检查工作流.md)
#### prettier + Eslint 代码自动格式化

前端的代码规范是个哲学问题，要不要规范，怎么做规范，大家都有点自己的想法。但是对于一个项目来说，统一规范还是没有异议的。然而，问题又来了，大家的代码格式化有些时候通过不了 eslint 的检测，这就尴尬了。而且怎么统一项目组成员的代码格式化规则也是个问题。这个时候就要请出我们的 prettier 了。

在本项目中，我们使用了 VSCode 插件的形式，这种方式配置项最简单，而且由于我们全员都使用了 VSCode 编辑器，接入也不麻烦。

后续我们会采用 `npm` 插件的形式，而不是 VSCode 插件的形式。原因如下：  
1. 更方便进行团队协作，而且也可以针对项目更好的进行订制化。  
2. 和 VSCode 解耦，减少不必要的限制。

> 详细内容可以查看：[Prettier的三种使用场景和使用方法](./Prettier的三种使用场景和使用方法.md)



